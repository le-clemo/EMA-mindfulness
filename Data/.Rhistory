pa.max.reml <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant) +
s(phaseBeepNum, by=group) + s(phaseBeepNum, by=intervention) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data)
summary(pa.max.reml)
pa.max1 <- bam(sumPA_gam ~ s(phaseBeepNum, by = interaction(group, intervention)) + group * intervention +
s(companyPleasant) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data)
summary(pa.max1)
save(pa.max1, pa.max.reml1, file = "models_pa/pa_Max.rda")
#removing s(phaseBeepNum, by=interaction(intervention))
pa1 <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(pa1, file = "models_pa/pa1_gam.rda")
compareML(pa.max1, pa1) #pa1 preferred
pa.max1 <- bam(sumPA_gam ~ s(phaseBeepNum, by = interaction(group, intervention)) + group * intervention +
s(companyPleasant) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
compareML(pa.max1, pa1) #pa1 preferred
compareML(pa3, pa4) #significant difference --> pa3 preferred
#removing s(negIntensity_gam)
pa5 <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant) +
s(ruminating_gam) + s(sumNA_gam) +
s(posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(pa5, file = "models_pa/pa5_gam.rda")
compareML(pa3, pa5) #significant difference --> pa11 preferred
#removing s(sleepQuality_gam)
pa6 <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(pa6, file = "models_pa/pa6_gam.rda")
compareML(pa3, pa6) #no significant difference --> pa14 preferred
#removing s(stickiness_gam)
pa7 <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(pa7, file = "models_pa/pa7_gam.rda")
compareML(pa3, pa7) #no significant difference --> pa15 preferred
#removing  s(distracted_gam)
pa8 <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) +
s(stickiness_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(pa8, file = "models_pa/pa8_gam.rda")
compareML(pa3, pa8) #significant difference --> pa15 preferred
#removing s(stickiness_gam)
pa9 <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) +
s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(pa9, file = "models_pa/pa9_gam.rda")
compareML(pa8, pa9) #significant difference --> pa15 preferred
#removing s(ruminating_gam)
pa10 <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant) +
s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) +
s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(pa10, file = "models_pa/pa10_gam.rda")
compareML(pa9, pa10) #significant difference --> pa15 preferred
#removing s(sumNA_gam)
pa11 <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant) +
s(ruminating_gam) +
s(negIntensity_gam) + s(posIntensity_gam) +
s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(pa11, file = "models_pa/pa11_gam.rda")
compareML(pa9, pa11) #significant difference --> pa15 preferred
#removing  s(companyPleasant)
pa12 <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) +
s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(pa12, file = "models_pa/pa12_gam.rda")
compareML(pa9, pa12) #no significant difference --> pa9 preferred
pa.m1 <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) +
s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data)
summary_pa.m1 <- summary(pa.m1)
save(pa.m1, summary_pa.m1, file="models_na/pa.m1.rda")
summary_pa.m1
plot_smooth(pa.m1, view="phaseBeepNum", rug=F, plot_all="intervention")
plot_smooth(pa.m1, view="phaseBeepNum", rug=F, plot_all="group")
# check autocorrelation
model1.acf <- acf_resid(pa.m1)
#check model fit
gam.check(pa.m1)
#plot the model based predicted differences between interventions (summed effects)
plot_parametric(pa.m1, pred=list(intervention=c("mindfulness", "fantasizing")))
#and between groups
plot_parametric(pa.m1, pred=list(intervention=c("mindfulness", "fantasizing"), group=c("controls", "remitted")))
# plot differences
plot_diff(pa.m1, view="phaseBeepNum", comp=list("intervention"=c("mindfulness", "fantasizing")), main="mindfulness vs fantasizing")
plot_diff(pa.m1, view="phaseBeepNum", comp=list( group=c("remitted", "remitted"), intervention=c("mindfulness", "fantasizing")))
#,main="mindfulness vs fantasizing")
plot_diff(pa.m1, view="phaseBeepNum", comp=list( group=c("controls", "controls"), intervention=c("mindfulness", "fantasizing")))
# intercept model to compare with winner model
pa.int <- bam(sumPA_gam ~ 1 + s(phaseBeepNum, by=subject, bs="fs", m=1), data=sc_data, method="ML")
compareML(pa.int, pa9) #g17 clearly outperforms the intercept model
#Maximum model with ML
na.max <- bam(sumNA_gam ~ s(phaseBeepNum) + group * intervention * thoughtsValence * thoughtsTime +
aloneCompany + s(alonePleasant_gam) + s(companyPleasant_gam) +
s(phaseBeepNum, by=group) + s(phaseBeepNum, by=intervention) +
s(ruminating_gam) + s(sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
na.max <- bam(sumNA_gam ~ s(phaseBeepNum) + group * intervention * thoughtsValence * thoughtsTime +
s(alonePleasant_gam) + s(companyPleasant_gam) +
s(phaseBeepNum, by=group) + s(phaseBeepNum, by=intervention) +
s(ruminating_gam) + s(sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
na.max <- bam(sumNA_gam ~ s(phaseBeepNum) + group * intervention + thoughtsValence + thoughtsTime +
s(alonePleasant_gam) + s(companyPleasant_gam) +
s(phaseBeepNum, by=group) + s(phaseBeepNum, by=intervention) +
s(ruminating_gam) + s(sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
na.max <- bam(sumNA_gam ~ s(phaseBeepNum) + group * intervention + thoughtsTime +
s(alonePleasant_gam) + s(companyPleasant_gam) +
s(phaseBeepNum, by=group) + s(phaseBeepNum, by=intervention) +
s(ruminating_gam) + s(sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
na.max <- bam(sumNA_gam ~ s(phaseBeepNum) + group * intervention +
s(alonePleasant_gam) + s(companyPleasant_gam) +
s(phaseBeepNum, by=group) + s(phaseBeepNum, by=intervention) +
s(ruminating_gam) + s(sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
na.max <- bam(sumNA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(phaseBeepNum, by=group) + s(phaseBeepNum, by=intervention) +
s(ruminating_gam) + s(sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
#removing s(phaseBeepNum, by=intervention)
na1 <- bam(sumNA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(phaseBeepNum, by=group) +
s(ruminating_gam) + s(sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(na1, file = "models_na/na1_gam.rda")
compareML(na.max, na1) #no significant difference --> na1 preferred
na.max1 <- bam(sumNA_gam ~ s(phaseBeepNum) + s(phaseBeepNum, by=interaction(group, intervention)) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
compareML(na.max1, na1) #no significant difference --> na1 preferred
#removing s(phaseBeepNum, by=group)
na2 <- bam(sumNA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(na2, file = "models_na/na2_gam.rda")
compareML(na1, na2) # no significant difference --> na2 preferred
#removing s(companyPleasant_gam)
na3 <- bam(sumNA_gam ~ s(phaseBeepNum) + group * intervention +
s(ruminating_gam) + s(sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(na3, file = "models_na/na3_gam.rda")
compareML(na2, na3) #significant difference --> na2 preferred
gam.max <- bam(ruminating_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(phaseBeepNum, by=group) + s(phaseBeepNum, by=intervention) +
s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
gam.max <- bam(ruminating_gam ~ s(phaseBeepNum) + s(phaseBeepNum, by = interaction(group, intervention)) + group * intervention +
s(companyPleasant_gam) +
s(phaseBeepNum, by=group) + s(phaseBeepNum, by=intervention) +
s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(g0, file = "models_rumination/g0_gam.rda")
#removing s(phaseBeepNum, by=intervention)
g0 <- bam(ruminating_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(phaseBeepNum, by=group) + s(phaseBeepNum, by = intervention) +
s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(g0, file = "models_rumination/g0_gam.rda")
compareML(gam.max, g0) # g1 preferred
#removing both s(phaseBeepNum, by=group) and s(phaseBeepNum, by=intervention)
g2 <- bam(ruminating_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(g2, file = "models_rumination/g2_gam.rda")
#removing s(companyPleasant_gam)
g9 <- bam(ruminating_gam ~ s(phaseBeepNum) + group * intervention +
s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(g9, file = "models_rumination/g9_gam.rda")
compareML(g2, g9) #significant difference --> g2 preferred
pa.max1 <- bam(sumPA_gam ~ s(phaseBeepNum, by = interaction(group, intervention)) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
#removing s(phaseBeepNum, by=interaction(intervention))
pa2 <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(pa2, file = "models_pa/pa2_gam.rda")
compareML(pa.max1, pa2) #pa1 preferred
#removing s(companyPleasant_gam)
pa2a <- bam(sumPA_gam ~ s(phaseBeepNum) + group * intervention +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
compareML(pa2, pa2a) #pa1 preferred
sticky.max1 <- bam(stickiness_gam ~ s(phaseBeepNum) +s(phaseBeepNum, by = interaction(group,intervention)) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
sticky.max1 <- bam(stickiness_gam ~ s(phaseBeepNum) + s(phaseBeepNum, by = interaction(group,intervention)) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
#Maximum model with ML
sticky.max <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(phaseBeepNum, by=group) + s(phaseBeepNum, by=intervention) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(stickiness_gam) + s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
#Maximum model with ML
sticky.max <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(phaseBeepNum, by=group) + s(phaseBeepNum, by=intervention) +
s(ruminating_gam) + s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
sticky.max1 <- bam(stickiness_gam ~ s(phaseBeepNum) + s(phaseBeepNum, by=interaction(group,intervention)) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
compareML(sticky.max, sticky.max1) # preferred
#removing s(phaseBeepNum, by=intervention)
sticky1 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(phaseBeepNum, by=group) +
s(ruminating_gam) + s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky2, file = "models_stickiness/sticky2_gam.rda")
save(sticky1, file = "models_stickiness/sticky1_gam.rda")
compareML(sticky.max, sticky1) #no significant difference --> sticky2 preferred
#removing s(phaseBeepNum, by=group)
sticky2 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky2, file = "models_stickiness/sticky2_gam.rda")
compareML(sticky1, sticky2) #no significant difference --> sticky1 preferred
#removing s(companyPleasant_gam) +
sticky3 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(ruminating_gam) + s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) + ti(negIntensity_gam, posIntensity_gam) +
s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky3, file = "models_stickiness/sticky3_gam.rda")
compareML(sticky2, sticky3) #no significant difference --> sticky1 preferred
#removing ti(negIntensity_gam, posIntensity_gam)
sticky4 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) + s(posIntensity_gam) +
s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky4, file = "models_stickiness/sticky4_gam.rda")
compareML(sticky2, sticky4) #no significant difference --> sticky2 preferred
#removing  s(posIntensity_gam) +
sticky5 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) +
s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky5, file = "models_stickiness/sticky5_gam.rda")
compareML(sticky4, sticky5) #no significant difference --> sticky4 preferred
#removing  s(negIntensity_gam) +
sticky6 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(distracted_gam) + s(listless_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky6, file = "models_stickiness/sticky6_gam.rda")
compareML(sticky5, sticky6) #no significant difference --> sticky4 preferred
#removing s(sleepQuality_gam)
sticky7 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) +
s(distracted_gam) + s(listless_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky7, file = "models_stickiness/sticky7_gam.rda")
compareML(sticky5, sticky7) #significant difference --> sticky10 preferred
#removing s(listless_gam)
sticky8 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) +
s(distracted_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky8, file = "models_stickiness/sticky8_gam.rda")
compareML(sticky5, sticky8) #significant difference --> sticky5 preferred
#removing s(distracted_gam)
sticky9 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) + s(sumPA_gam) + ti(sumNA_gam, sumPA_gam) +
s(negIntensity_gam) +
s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky9, file = "models_stickiness/sticky9_gam.rda")
compareML(sticky8, sticky9) #significant difference --> sticky12 preferred
#removing ti(sumNA_gam, sumPA_gam)
sticky10 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) + s(sumPA_gam) +
s(negIntensity_gam) +
s(distracted_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky10, file = "models_stickiness/sticky10_gam.rda")
compareML(sticky8, sticky10) #no significant difference --> sticky14 preferred
#removing  s(sumPA_gam) +
sticky11 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) +
s(distracted_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky11, file = "models_stickiness/sticky11_gam.rda")
compareML(sticky10, sticky11) #nsignificant difference --> sticky15 preferred
#removing  s(sumNA_gam) +
sticky12 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) +
s(negIntensity_gam) +
s(distracted_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky12, file = "models_stickiness/sticky12_gam.rda")
compareML(sticky11, sticky12) #no significant difference --> sticky11 preferred
#removing  s(ruminating_gam) +
sticky13 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(sumNA_gam) +
s(negIntensity_gam) +
s(distracted_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data, method = "ML")
save(sticky13, file = "models_stickiness/sticky13_gam.rda")
compareML(sticky11, sticky13) #significant difference --> sticky11 preferred
sticky.m1 <- bam(stickiness_gam ~ s(phaseBeepNum) + group * intervention +
s(companyPleasant_gam) +
s(ruminating_gam) + s(sumNA_gam) +
s(negIntensity_gam) +
s(distracted_gam) + s(sleepQuality_gam) +
s(phaseBeepNum, by = subject, bs="fs", m=1),
data = sc_data)
summary_sticky.m1 <- summary(sticky.m1)
save(sticky.m1, summary_sticky.m1, file="models_stickiness/sticky.m1.rda")
summary_sticky.m1
plot_smooth(sticky.m1, view="phaseBeepNum", rug=F, plot_all="intervention")
plot_smooth(sticky.m1, view="phaseBeepNum", rug=F, plot_all="group")
# check autocorrelation
model1.acf <- acf_resid(sticky.m1)
#check model fit
gam.check(sticky.m1)
#plot the model based predicted differences between interventions (summed effects)
plot_parametric(sticky.m1, pred=list(intervention=c("mindfulness", "fantasizing")))
#and between groups
plot_parametric(sticky.m1, pred=list(intervention=c("mindfulness", "fantasizing"), group=c("controls", "remitted")))
# plot differences
plot_diff(sticky.m1, view="phaseBeepNum", comp=list("intervention"=c("mindfulness", "fantasizing")), main="mindfulness vs fantasizing")
plot_diff(sticky.m1, view="phaseBeepNum", comp=list( group=c("remitted", "remitted"), intervention=c("mindfulness", "fantasizing")))
#,main="mindfulness vs fantasizing")
plot_diff(sticky.m1, view="phaseBeepNum", comp=list( group=c("controls", "controls"), intervention=c("mindfulness", "fantasizing")))
# intercept model to compare with winner model
sticky.int <- bam(stickiness_gam ~ 1 + s(phaseBeepNum, by=subject, bs="fs", m=1), data=sc_data, method="ML")
plot_smooth(sticky.m1, view="phaseBeepNum", rug=F, comp=list(group=c("remitted","remitted"),
intervention=c("mindfulness", "fantasizing")))
plot_smooth(sticky.m1, view="phaseBeepNum", rug=F, plot_all=list(group=c("remitted","remitted"),
intervention=c("mindfulness", "fantasizing")))
#,main="mindfulness vs fantasizing")
plot_diff(sticky.m1, view="phaseBeepNum", comp=list( group=c("controls", "controls"), intervention=c("mindfulness", "fantasizing")))
# intercept model to compare with winner model
sticky.int <- bam(stickiness_gam ~ 1 + s(phaseBeepNum, by=subject, bs="fs", m=1), data=sc_data, method="ML")
summary(sticky.int)
compareML(sticky.int, sticky15) #g17 clearly outperforms the intercept model
# intercept model to compare with winner model
sticky.int <- bam(stickiness_gam ~ 1 + s(phaseBeepNum, by=subject, bs="fs", m=1), data=sc_data, method="ML")
compareML(sticky.int, sticky11) #g17 clearly outperforms the intercept model
